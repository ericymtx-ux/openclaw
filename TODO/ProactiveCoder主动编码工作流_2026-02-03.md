# Proactive Coder ä¸»åŠ¨ç¼–ç å·¥ä½œæµ

**åˆ›å»ºæ—¥æœŸ**: 2026-02-03
**çŠ¶æ€**: å¾…å¼€å‘
**ä¼˜å…ˆçº§**: P0
**é¢„ä¼°æ€»å·¥æ—¶**: 20 å°æ—¶

---

## éœ€æ±‚æ¦‚è¿°

å®ç°å¤œé—´è‡ªåŠ¨å¼€å‘å·¥ä½œæµï¼Œ23:00-07:00 ç‹¬ç«‹å·¥ä½œï¼Œæ¯æ—¥äº§å‡º PRï¼Œç”±ç”¨æˆ·æ¬¡æ—¥å®¡æ ¸ã€‚

---

## å®ç°æ–¹æ¡ˆ

### æŠ€æœ¯æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 Cron Trigger (23:00)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                Night Work Manager                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Task     â”‚ â”‚ OpenCode â”‚ â”‚ Progress â”‚ â”‚ PR       â”‚   â”‚
â”‚  â”‚ Scanner  â”‚ â”‚ Schedulerâ”‚ â”‚ Tracker  â”‚ â”‚ Creator  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â–¼               â–¼               â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚OpenCode â”‚    â”‚Claude   â”‚    â”‚ Scripts â”‚
     â”‚         â”‚    â”‚ Code    â”‚    â”‚         â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 GitHub PR Created                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ¨¡å—å®ç°

| æ¨¡å— | å®ç°æ–¹å¼ | ä¾èµ– |
|------|----------|------|
| ä»»åŠ¡æ‰«æ | è¯»å– BOT_TASKS + TODO/ | å·²å­˜åœ¨ |
| ä»»åŠ¡ç­›é€‰ | è§„åˆ™åˆ¤æ–­ | æ–°å¼€å‘ |
| è°ƒåº¦å™¨ | OpenCode + Claude Code | å·²å­˜åœ¨ |
| è¿›åº¦è·Ÿè¸ª | çŠ¶æ€æ›´æ–° | æ–°å¼€å‘ |
| PR åˆ›å»º | GitHub CLI | å·²å­˜åœ¨ |

---

## ä»»åŠ¡æ‹†åˆ†

### Phase 1: ä»»åŠ¡æ‰«æä¸ç­›é€‰ (6h)

#### T1.1: ä»»åŠ¡æ¥æºé›†æˆ
- **å·¥æ—¶**: 2h
- **éªŒæ”¶**: æ­£ç¡®è¯»å– BOT_TASKS.md + TODO/
- **å®ç°**:
  - BOT_TASKS.md è§£æ
  - TODO/ æ‰«æ
  - ideas/ æ–°æƒ³æ³•è¯†åˆ«

```python
class TaskScanner:
    SOURCES = [
        "BOT_TASKS.md",
        "TODO/*.md",
        "ideas/*.md"
    ]

    def scan_all(self) -> List[Task]:
        """æ‰«ææ‰€æœ‰ä»»åŠ¡æ¥æº"""
        tasks = []
        tasks.extend(self.scan_bot_tasks())
        tasks.extend(self.scan_todo_dir())
        tasks.extend(self.scan_ideas())
        return tasks
```

#### T1.2: ä»»åŠ¡è‡ªåŠ¨ç­›é€‰ç®—æ³•
- **å·¥æ—¶**: 2h
- **éªŒæ”¶**: å‡†ç¡®è¯†åˆ«å¯è‡ªåŠ¨å®Œæˆçš„ä»»åŠ¡
- **è§„åˆ™**:

```python
def can_auto_complete(task: Task) -> bool:
    """
    å¯è‡ªåŠ¨å®Œæˆçš„æ¡ä»¶:
    - æœ‰æ˜ç¡®éªŒæ”¶æ ‡å‡† (DOD.md)
    - ä¸éœ€è¦ç”¨æˆ·å†³ç­–
    - æœ‰ç°æœ‰ä»£ç åº“å‚è€ƒ
    - ä¸æ¶‰åŠå¤–éƒ¨ä¾èµ–(API keys ç­‰)
    - ä¸ä¿®æ”¹æ ¸å¿ƒé€»è¾‘

    ä¸å¯è‡ªåŠ¨å®Œæˆ:
    - éœ€è¦ç”¨æˆ·ç¡®è®¤æ–¹å‘
    - æ¶‰åŠä¸šåŠ¡å†³ç­–
    - éœ€è¦å¤–éƒ¨èµ„æº(ç”¨æˆ·å®‰è£…)
    - é«˜é£é™©å˜æ›´
    """
    if task.requires_user_decision:
        return False
    if task.has_external_dependencies:
        return False
    if task.is_high_risk:
        return False
    if not task.has_clear_dod:
        return False
    return True
```

#### T1.3: ä»»åŠ¡ä¼˜å…ˆçº§æ’åº
- **å·¥æ—¶**: 2h
- **éªŒæ”¶**: æŒ‰æ­£ç¡®ä¼˜å…ˆçº§æ’åºä»»åŠ¡
- **ä¼˜å…ˆçº§**:
  - P0: ç´§æ€¥ Bug
  - P1: æ ¸å¿ƒåŠŸèƒ½
  - P2: æ”¹è¿›ä¼˜åŒ–
  - P3: æ¢ç´¢ç ”ç©¶

### Phase 2: è°ƒåº¦å™¨å®ç° (8h)

#### T2.1: OpenCode è°ƒåº¦é›†æˆ
- **å·¥æ—¶**: 3h
- **éªŒæ”¶**: æ­£ç¡®è°ƒç”¨ OpenCode skill
- **å®ç°**:
  - ä»»åŠ¡ â†’ OpenCode å‚æ•°è½¬æ¢
  - è¿›åº¦å›è°ƒ
  - ç»“æœæ”¶é›†

```python
class OpenCodeScheduler:
    def schedule_task(self, task: Task) -> ExecutionResult:
        """
        è°ƒåº¦ OpenCode æ‰§è¡Œä»»åŠ¡:
        1. ç”Ÿæˆ prompt
        2. è°ƒç”¨ opencode-team
        3. æ”¶é›†ç»“æœ
        4. æ›´æ–°çŠ¶æ€
        """
        prompt = self.generate_prompt(task)
        result = call_opencode(prompt)
        self.update_task_status(task, result)
        return result
```

#### T2.2: Claude Code è°ƒåº¦é›†æˆ
- **å·¥æ—¶**: 3h
- **éªŒæ”¶**: æ­£ç¡®è°ƒç”¨ Claude Code skill
- **å®ç°**:
  - å¤æ‚ä»»åŠ¡è¯†åˆ«
  - Claude Code è°ƒç”¨
  - ç»“æœå¤„ç†

```python
class ClaudeCodeScheduler:
    def should_use_claude_code(self, task: Task) -> bool:
        """
        å¤æ‚ä»»åŠ¡ä½¿ç”¨ Claude Code:
        - éœ€è¦å¤šæ–‡ä»¶ä¿®æ”¹
        - æ¶‰åŠæ¶æ„è®¾è®¡
        - éœ€è¦ä»£ç å®¡æŸ¥
        """
        return task.complexity > threshold

    def execute(self, task: Task) -> ExecutionResult:
        """è°ƒç”¨ Claude Code"""
        return call_claude_code(task)
```

#### T2.3: æ‰§è¡Œé˜Ÿåˆ—ç®¡ç†
- **å·¥æ—¶**: 2h
- **éªŒæ”¶**: æ­£ç¡®ç®¡ç†å¹¶è¡Œæ‰§è¡Œ
- **å®ç°**:
  - é˜Ÿåˆ—çŠ¶æ€ç®¡ç†
  - å¹¶å‘æ§åˆ¶ (maxConcurrent)
  - å¤±è´¥é‡è¯•

### Phase 3: è¿›åº¦è·Ÿè¸ªä¸é€šçŸ¥ (4h)

#### T3.1: è¿›åº¦å®æ—¶æ›´æ–°
- **å·¥æ—¶**: 2h
- **éªŒæ”¶**: ä»»åŠ¡çŠ¶æ€å®æ—¶æ›´æ–°
- **å®ç°**:
  - è¿›åº¦å›è°ƒ
  - çŠ¶æ€æŒä¹…åŒ–
  - è¿›åº¦é€šçŸ¥

```python
class ProgressTracker:
    def __init__(self):
        self.current_task = None
        self.completed_tasks = []
        self.failed_tasks = []

    def start_task(self, task: Task):
        self.current_task = task
        self.save_progress()

    def complete_task(self, task: Task, result: str):
        self.current_task = None
        self.completed_tasks.append((task, result))
        self.save_progress()

    def get_progress_report(self) -> str:
        """ç”Ÿæˆè¿›åº¦æŠ¥å‘Š"""
        return f"å·²å®Œæˆ {len(self.completed_tasks)}/{total} ä»»åŠ¡"
```

#### T3.2: è¿›åº¦é€šçŸ¥ (å¯é€‰)
- **å·¥æ—¶**: 1h
- **éªŒæ”¶**: é‡è¦èŠ‚ç‚¹å‘é€é€šçŸ¥
- **è§¦å‘**:
  - ä»»åŠ¡å¼€å§‹
  - ä»»åŠ¡å®Œæˆ
  - ä»»åŠ¡å¤±è´¥
  - PR åˆ›å»ºå®Œæˆ

#### T3.3: ç»“æœæŒä¹…åŒ–
- **å·¥æ—¶**: 1h
- **éªŒæ”¶**: æ‰§è¡Œç»“æœä¿å­˜
- **ä½ç½®**: `~/.openclaw/night_work/`

### Phase 4: PR è‡ªåŠ¨åˆ›å»º (2h)

#### T4.1: PR æ¨¡æ¿ç”Ÿæˆ
- **å·¥æ—¶**: 1h
- **éªŒæ”¶**: æ­£ç¡®ç”Ÿæˆ PR å†…å®¹
- **æ¨¡æ¿**:

```markdown
## ğŸŒ™ Night Work - YYYY-MM-DD

### å®Œæˆå†…å®¹
- [ ] åŠŸèƒ½1
- [ ] åŠŸèƒ½2
- [ ] æµ‹è¯•è¡¥å……
- [ ] æ–‡æ¡£æ›´æ–°

### æµ‹è¯•è¯´æ˜
1. è¿è¡Œæ–¹å¼
2. é¢„æœŸç»“æœ
3. éªŒè¯æ­¥éª¤

### å½±å“èŒƒå›´
- ä¿®æ”¹æ–‡ä»¶: xxx
- æ–°å¢æ–‡ä»¶: xxx

---
*ç”± Monday åœ¨å¤œé—´è‡ªåŠ¨å®Œæˆ*
```

#### T4.2: è‡ªåŠ¨åˆ›å»º PR
- **å·¥æ—¶**: 1h
- **éªŒæ”¶**: PR åˆ›å»ºæˆåŠŸ
- **å®ç°**:
  - åˆ›å»ºç‹¬ç«‹åˆ†æ”¯
  - æäº¤æ›´æ”¹
  - åˆ›å»º PR

```python
class PRCreator:
    def create_pr(self, work_result: WorkResult) -> str:
        """åˆ›å»º PR"""
        branch = f"monday/{date}/night-work"
        self.git.checkout("-b", branch)
        self.git.add(".")
        self.git.commit(f"Night work: {date}")
        self.git.push(branch)
        pr_url = self.gh.pr.create(branch, "main", title, body)
        return pr_url
```

---

## éªŒæ”¶æ ‡å‡† (DoD)

- [x] æ­£ç¡®æ‰«æ BOT_TASKS.md + TODO/
- [x] å‡†ç¡®è¯†åˆ«å¯è‡ªåŠ¨å®Œæˆçš„ä»»åŠ¡
- [x] æŒ‰ä¼˜å…ˆçº§æ‰§è¡Œä»»åŠ¡
- [x] OpenCode/Claude Code è°ƒåº¦æ­£å¸¸
- [x] è¿›åº¦å®æ—¶æ›´æ–°
- [x] æ¯æ—¥åˆ›å»º PR
- [x] PR æ¨¡æ¿æ­£ç¡®
- [x] Cron å®šæ—¶è§¦å‘æ­£å¸¸ (æ¯å¤© 23:00)
- [ ] ç«¯åˆ°ç«¯æµ‹è¯•é€šè¿‡

---

## ä¾èµ–

| ä¾èµ– | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| BOT_TASKS.md | âœ… å·²å­˜åœ¨ | ä»»åŠ¡æ¥æº |
| OpenCode skill | âœ… å·²å­˜åœ¨ | ä»£ç æ‰§è¡Œ |
| Claude Code skill | âœ… å·²å­˜åœ¨ | å¤æ‚ä»»åŠ¡ |
| GitHub CLI | âœ… å·²å­˜åœ¨ | PR åˆ›å»º |
| cron | âœ… å·²å­˜åœ¨ | å®šæ—¶è§¦å‘ |

---

## é£é™©

| é£é™© | åº”å¯¹æªæ–½ |
|------|----------|
| ä»»åŠ¡æ‰§è¡Œå¤±è´¥ | è®°å½•å¤±è´¥ï¼Œä¸é˜»å¡åç»­ |
| PR å†²çª | è§£å†³å†²çªæˆ–è·³è¿‡ |
| æ‰§è¡Œè¶…æ—¶ | è®¾ç½® 6h è¶…æ—¶é™åˆ¶ |
| èµ„æºå ç”¨ | æ§åˆ¶å¹¶å‘æ•° |

---

## è¿›åº¦è¿½è¸ª

| ä»»åŠ¡ | çŠ¶æ€ | è´Ÿè´£äºº | å®Œæˆæ—¶é—´ |
|------|------|--------|----------|
| T1.1 ä»»åŠ¡æ¥æº | âœ… | Monday | 2026-02-03 |
| T1.2 ç­›é€‰ç®—æ³• | âœ… | Monday | 2026-02-03 |
| T1.3 ä¼˜å…ˆçº§æ’åº | âœ… | Monday | 2026-02-03 |
| T2.1 OpenCode è°ƒåº¦ | âœ… | Monday | 2026-02-03 |
| T2.2 Claude Code è°ƒåº¦ | âœ… | Monday | 2026-02-03 |
| T2.3 é˜Ÿåˆ—ç®¡ç† | â³ | - | - |
| T3.1 è¿›åº¦è·Ÿè¸ª | âœ… | Monday | 2026-02-03 |
| T3.2 è¿›åº¦é€šçŸ¥ | â³ | - | - |
| T3.3 ç»“æœæŒä¹…åŒ– | âœ… | Monday | 2026-02-03 |
| T4.1 PR æ¨¡æ¿ | âœ… | Monday | 2026-02-03 |
| T4.2 PR åˆ›å»º | âœ… | Monday | 2026-02-03 |
| T5.1 Cron è§¦å‘ | âœ… | Monday | 2026-02-03 |

---

## æ›´æ–°è®°å½•

| æ—¥æœŸ | æ›´æ–°å†…å®¹ |
|------|----------|
| 2026-02-03 | Phase 2 Cron é›†æˆ: æ·»åŠ  cron job "Night Work Main" (æ¯å¤© 23:00) |
| 2026-02-03 | Phase 2 å…¨éƒ¨å®Œæˆ: OpenCode + Claude Code é›†æˆ (mcporter) |
| 2026-02-03 | Phase 2 OpenCode é›†æˆå®Œæˆ: scheduler.py å®ç° + å•å…ƒæµ‹è¯•é€šè¿‡ |

---

*åˆ›å»ºæ—¶é—´: 2026-02-03*
