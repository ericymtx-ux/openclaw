# Stock Stars 可视化模块开发计划

**创建日期**: 2026-02-04 16:45
**状态**: 待开发
**优先级**: P1

---

## 📊 数据源分析

### SignalParser 输出字段

| 字段 | 类型 | 可视化价值 | 决策辅助 |
|------|------|------------|----------|
| `code` | 代码 | 关联查询 | 标的识别 |
| `name` | 名称 | 标签展示 | 快速识别 |
| `action` | 操作(开/持/平) | **分类筛选** | 核心决策 |
| `price` | 价格 | **趋势/区间** | 买入时机 |
| `change_pct` | 涨跌幅 | **柱状/散点** | 强势判断 |
| `volume_relation` | 量价关系 | 模式识别 | 资金行为 |
| `heat_rank` | 热度排名 | **排行榜** | 热点追踪 |
| `heat_value` | 热度值 | **热力图/趋势** | 强度量化 |
| `net_amount` | 大单净额 | **资金流向图** | 主力动向 |
| `signal_date` | 日期 | 时间轴 | 持续性分析 |
| `industry` | 行业 | **板块分布** | 板块联动 |

---

## 🎯 决策辅助图表设计

### 1. 热度-资金矩阵 (Heat vs Capital Flow)

**用途**: 识别被主力资金追捧的热点标的

```
                大单流入 ▲
                     │
         强势买入区   │   主力建仓区
    (高热度+正流入)  │  (低热度+正流入)
                     │
    ◄───────────────┼───────────────►
         冷门区     │   观望区
    (低热度+负流入)  │  (高热度+负流出)
                     │
                     ▼
                大单流出
```

**决策信号**:
- 🔴 右上角: 重点关注 (热度+资金双驱动)
- 🟡 左上角: 关注低吸机会
- ⚪ 右下角: 回避 (主力出货)
- 🔵 左下角: 忽略

---

### 2. 情绪温度计时序图

**用途**: 判断市场情绪周期，指导仓位管理

```
情绪指数
  100% │ 🔥 过热警戒线
       │ ═════════════
   75% │ ██████████████
       │ ████████████
   50% │ ████████
       │ ████
   25% │ ██
       │ █
     0% │ ❄️ 低落
       └─────────────────► 时间
           1D 3D 1W 1M
```

**决策信号**:
- 情绪 > 70%: 减仓止盈
- 情绪 < 30%: 逢低布局
- 情绪 40-60%: 均衡配置

---

### 3. 板块热度雷达图

**用途**: 发现板块轮动机会

```
           新能源
              ▲
             /│\
    AI应用 ◄──┼──► 消费
             \│/
              ▼
           有色金属

雷达维度:
- 热度值
- 信号数量
- 平均涨幅
- 资金净流入
- 持续天数
```

---

### 4. 信号强度散点图

**用途**: 量化信号质量，过滤噪音

```
涨跌幅 %
    │
 +10 │     ★ 强势信号
     │    ● ●
  +5 │   ● ● ●
     │  ● ● ● ● ●
  0  │ ●━━━━━━━━━━━●
     │  ● ● ● ● ●
  -5 │   ● ●
     │    ●
 -10 │     ○ 弱势信号
     └─────────────────► 热度排名
        1    50   100
```

**决策**:
- 右下角 (高热度+高涨幅) = 强信号
- 左上角 (低热度+低涨幅) = 过滤

---

### 5. 历史胜率趋势图

**用途**: 验证信号有效性，调整策略

```
胜率 %
 100% │     ╱╲
      │    ╱  ╲
   80%│───╱    ╲───────
      │ ╱        ╲
   60%│╱          ╲──
      │
   40%│
      └──────────────────►
        周1 周2 周3 周4

按行业/信号类型分组展示
```

---

### 6. 资金流向 Sankey 图

**用途**: 追踪资金在板块间的流动

```
┌─────────┐    ┌─────────┐    ┌─────────┐
│ 新能源   │───►│ 锂电池   │───►│ 整车    │
│ 50亿     │    │ 30亿     │    │ 20亿    │
└─────────┘    └─────────┘    └─────────┘
      │
      ▼
┌─────────┐
│ 光伏    │ 流出 15亿
└─────────┘
```

---

## 📈 可视化模块架构

```
modules/signals/
├── __init__.py
├── signal_parser.py       # 现有
├── signal_storage.py      # 现有
├── visualization.py      # ⭐ 新增: 可视化模块
└── charts/                # 图表生成器
    ├── heat_map.py       # 热度热力图
    ├── capital_flow.py   # 资金流向图
    ├── emotion_gauge.py  # 情绪仪表
    ├── scatter.py         # 散点图
    ├── radar.py          # 雷达图
    └── dashboard.py      # 综合仪表板
```

---

## 🎯 开发优先级

| 优先级 | 图表 | 决策价值 | 开发难度 |
|--------|------|----------|----------|
| P0 | 热度-资金矩阵 | ⭐⭐⭐⭐⭐ | 中 |
| P0 | 情绪仪表盘 | ⭐⭐⭐⭐⭐ | 低 |
| P1 | 信号强度散点 | ⭐⭐⭐⭐ | 中 |
| P1 | 板块雷达图 | ⭐⭐⭐ | 中 |
| P2 | 资金 Sankey | ⭐⭐⭐ | 高 |
| P2 | 历史胜率趋势 | ⭐⭐⭐⭐ | 中 |

---

## 📊 核心图表详细设计

### 图表1: 热度-资金矩阵 (Heat-Capital Matrix)

**数据输入**:
```python
signals = [
    {"name": "白银有色", "heat_value": 12500000, "net": 3.42, "action": "开"},
    {"name": "航天发展", "heat_value": 9853086, "net": -8.98, "action": "持"},
    ...
]
```

**图表输出**:
```
                    大单净额 (亿)
                      +5     0     -5
                      │      │      │
         1250万 ─────┼──────┼──────┼──────
                      │  🟢  │  🔵  │
         1000万 ─────┼──────┼──────┼──────
                      │ 白银  │ 航天 │
          800万 ─────┼──────┼──────┼──────
                      │  🔴  │  🔴  │
                      │ 比亚迪│ 五粮液│
                      └──────┼──────┘
                             │
                          热度值
```

**实现代码**:
```python
def plot_heat_capital_matrix(signals, save_path):
    """绘制热度-资金矩阵"""
    fig, ax = plt.subplots(figsize=(10, 8))
    
    # 散点图
    for s in signals:
        color = get_action_color(s['action'])
        size = s['heat_value'] / 1e6 * 10  # 热度值决定点大小
        ax.scatter(s['net'], s['heat_rank'], s=size, c=color, alpha=0.7)
        ax.annotate(s['name'], (s['net'], s['heat_rank']))
    
    # 添加象限分割线
    ax.axvline(x=0, color='gray', linestyle='--', alpha=0.5)
    ax.axhline(y=50, color='gray', linestyle='--', alpha=0.5)
    
    # 添加象限标签
    ax.text(3, 10, '强势区', fontsize=12, color='green')
    ax.text(-5, 10, '建仓区', fontsize=12, color='blue')
    ax.text(3, 90, '过热区', fontsize=12, color='red')
    ax.text(-5, 90, '冷门区', fontsize=12, color='gray')
    
    return fig
```

---

### 图表2: 情绪仪表盘 (Emotion Gauge)

**数据输入**:
```python
emotion_data = {
    "score": 63,        # 情绪得分 0-100
    "buy_ratio": 0.5,   # 买入占比
    "avg_heat": 5.2e6,  # 平均热度
    "net_flow": 2.5     # 净流入(亿)
}
```

**图表输出**:
```
        ╔═══════════════════╗
        ║     情绪指数       ║
        ║       63 🌡️       ║
        ║    Normal         ║
        ╠═══════════════════╣
        ║ 买入占比: 50%      ║
        ║ 平均热度: 520万    ║
        ║ 净流入: +2.5亿    ║
        ╚═══════════════════╝
```

---

## ✅ 开发验收标准

- [ ] 可视化模块接入 SignalParser
- [ ] 支持 4 种以上图表类型
- [ ] 图表可保存为 PNG/SVG
- [ ] Telegram 消息格式发送
- [ ] 支持实时数据更新

---

## 📁 输出文件

```
modules/signals/
├── visualization.py      # 可视化主模块
└── charts/
    ├── __init__.py
    ├── matrix.py         # 热度-资金矩阵
    ├── gauge.py          # 情绪仪表
    ├── scatter.py        # 散点图
    └── radar.py          # 雷达图
```

---

*最后更新: 2026-02-04 16:45*
