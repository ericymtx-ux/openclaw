# HunyuanOCR ç«¯åˆ°ç«¯æµ‹è¯•æœ€ç»ˆæŠ¥å‘Š

**æ—¥æœŸ**: 2026-02-02  
**çŠ¶æ€**: âœ… **ç«¯åˆ°ç«¯è¿è¡ŒæˆåŠŸï¼Œä½†è¯†åˆ«å‡†ç¡®ç‡éœ€ä¼˜åŒ–**

## æµ‹è¯•ç»“æœ

### âœ… æˆåŠŸ
1. **æ¨¡å‹åŠ è½½**: `tencent/HunyuanOCR` æˆåŠŸåŠ è½½ (1.0B å‚æ•°)
2. **Processor åŠ è½½**: `AutoProcessor` æ­£å¸¸å·¥ä½œ
3. **å›¾ç‰‡å¤„ç†**: 
   - input_ids shape: [1, 302]
   - pixel_values shape: [1120, 768]
   - image_grid_thw: [[1, 20, 56]]
4. **Token åŒ¹é…**: image_tokens (292) == image_embeds (292) âœ…
5. **ç«¯åˆ°ç«¯ç”Ÿæˆ**: æ¨¡å‹èƒ½å¤Ÿç”Ÿæˆæ–‡æœ¬è¾“å‡º

### ğŸ“Š è¯†åˆ«ç»“æœ

**æµ‹è¯•å›¾ç‰‡**: åŒ…å« "Tencent Hunyuan OCR" å’Œ "Hello World 2026"

| Prompt | è¯†åˆ«ç»“æœ |
|--------|----------|
| æå–å›¾ç‰‡ä¸­çš„æ–‡å­— | "Tencent HuanQRC" (éƒ¨åˆ†æ­£ç¡®) |
| æ£€æµ‹å¹¶è¯†åˆ«å›¾ç‰‡ä¸­çš„æ–‡å­— | ä¹±ç  (é‡å¤å­—ç¬¦) |

### ğŸ”§ æŠ€æœ¯å‘ç°

1. **æ­£ç¡®çš„æ¨ç†æ–¹å¼**:
   - ä½¿ç”¨ `apply_chat_template` æ„å»ºè¾“å…¥
   - ä½¿ç”¨ `clean_repeated_substrings` æ¸…ç†è¾“å‡º
   - Trim è¾“å…¥éƒ¨åˆ†å decode

2. **ä¿®å¤çš„ Bug**:
   - `processing_hunyuan_vl.py` - æ·»åŠ  None æ£€æŸ¥
   - å®‰è£…ä¾èµ–: `accelerate`, `torchvision`

3. **é—®é¢˜**:
   - è¯†åˆ«å‡†ç¡®ç‡ä¸é«˜
   - è‹±æ–‡è¯†åˆ«è¾ƒå¥½ï¼Œä¸­æ–‡è¯†åˆ«å›°éš¾
   - å¯èƒ½éœ€è¦æ›´é«˜è´¨é‡çš„å›¾ç‰‡

## å»ºè®®

1. **æé«˜å›¾ç‰‡è´¨é‡**: ä½¿ç”¨æ›´é«˜åˆ†è¾¨ç‡ã€æ›´æ¸…æ™°çš„å›¾ç‰‡
2. **å°è¯• vLLM**: å®˜æ–¹æ–‡æ¡£æ¨èä½¿ç”¨ vLLM éƒ¨ç½²ï¼Œå¯èƒ½æ•ˆæœæ›´å¥½
3. **è°ƒæ•´å‚æ•°**: å°è¯•ä¸åŒçš„ max_new_tokens å’Œ prompt

## æµ‹è¯•å‘½ä»¤

```bash
cd /Users/apple/openclaw/projects/transformers-hyvl
source .venv/bin/activate
python3 test_hunyuan_ocr.py
```

## ç›¸å…³æ–‡ä»¶
- `/Users/apple/openclaw/memory/2026-02-02-hunyuan-ocr-e2e-result.md`
