# DEV_AGENT.md - 持续开发 Agent 配置

> 🤖 **自动化开发流程**：扫描项目 → 发现任务 → 添加到队列 → 空闲时执行

---

## 一、Agent 职责

### 1. 扫描源（每日扫描）
- `TODO/` - 待办任务文件
- `ideas/` - 创意和想法
- `projects/` - 项目目录
- `BOT_TASKS.md` - 现有任务队列

### 2. 发现类型
| 类型 | 标识 | 优先级 |
|------|------|--------|
| 🐛 Bug/修复 | `TODO:`, `FIXME:`, `BUG:` | P0 |
| 📝 文档补充 | 缺少 README、缺少注释 | P2 |
| ✨ 新功能 | ideas/ 中的可实现想法 | P1 |
| 🧪 测试补充 | 缺少测试文件 | P2 |
| 🔧 重构优化 | `REFACTOR:`, 代码重复 | P3 |

### 3. 自动执行条件
- 用户空闲（无消息超过 30 分钟）
- 任务优先级 ≤ P1
- 任务预估时间 ≤ 1 小时
- 符合 BOUNDARIES.md 安全边界

---

## 二、扫描规则

### 2.1 TODO/ 目录扫描
```
扫描 TODO/*.md 文件
提取 [ ] 未完成项
检查是否有 "blocked" 标记
```

### 2.2 ideas/ 目录扫描
```
扫描 ideas/*.md 文件
查找 "可实现"、"简单"、"快速" 关键词
检查是否已有对应 TODO
```

### 2.3 projects/ 目录扫描
```
扫描 projects/*/
检查：
- 是否有 README.md
- 是否有 tests/ 目录
- 代码中是否有 TODO/FIXME 注释
- pyproject.toml 依赖是否完整
```

---

## 三、任务模板

```markdown
### [T0XX] 任务名称

**类型**: 🐛 Bug / 📝 文档 / ✨ 功能 / 🧪 测试 / 🔧 重构
**来源**: TODO/xxx.md | ideas/xxx.md | projects/xxx
**优先级**: P0/P1/P2/P3
**预估时间**: Xmin
**自动执行**: ✅ 是 / ❌ 否（需确认）

**描述**:
简要描述任务内容

**执行步骤**:
1. 步骤1
2. 步骤2

**验收标准**:
- [ ] 标准1
- [ ] 标准2
```

---

## 四、执行流程

```
┌─────────────────┐
│   定时扫描      │  每 2 小时
│ (TODO/ideas/    │
│  projects)      │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│   任务发现      │
│ 提取可执行任务  │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│ 添加到          │
│ BOT_TASKS.md    │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│   空闲检测      │  用户无消息 > 30min
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│   启动 OpenCode │
│   执行任务      │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│   更新状态      │
│   通知用户      │
└─────────────────┘
```

---

## 五、安全边界（继承 BOUNDARIES.md）

### ✅ 可自动执行
- Bug 修复（明确的错误）
- 文档补充
- 测试补充
- 代码格式化

### ❌ 需要确认
- 新功能开发
- 架构变更
- 依赖更新
- 删除代码

---

## 六、Cron 配置

```
# 任务扫描：每 2 小时
0 */2 8-22 * * 1-5

# 空闲执行检查：每 30 分钟
0,30 * * * *
```

---

*最后更新: 2026-02-02*
